import{G as e,H as t,J as n,K as r,Q as i,V as a,W as o,Y as s,Z as c,et as l,m as u,n as d,ot as f,q as p,rt as m,tt as h,x as g}from"./index-DONMULiq.js";var _={class:`settings`},v=d(p({__name:`SettingsView`,setup(d){let f=m(`system`),p=m(!1),v=m(!1),y=m({name:`Cornerstone`,description:`数据管理平台`,allowRegistration:!0,maxFileSize:50}),b=m({type:`postgresql`,poolSize:10,timeout:30}),x=m({timeout:300,workDir:`/var/plugins`,autoUpdate:!1}),S=async()=>{p.value=!0;try{let e=await u.get();e.success&&e.data&&(y.value={name:e.data.system_name||`Cornerstone`,description:e.data.system_description||``,allowRegistration:e.data.allow_registration,maxFileSize:e.data.max_file_size},b.value={type:e.data.db_type||`postgresql`,poolSize:e.data.db_pool_size,timeout:e.data.db_timeout},x.value={timeout:e.data.plugin_timeout,workDir:e.data.plugin_work_dir||`./plugins`,autoUpdate:e.data.plugin_auto_update})}catch(e){g.error(e instanceof Error?e.message:`加载系统设置失败`)}finally{p.value=!1}},C=async e=>{v.value=!0;try{let t=await u.update({system_name:y.value.name,system_description:y.value.description,allow_registration:y.value.allowRegistration,max_file_size:y.value.maxFileSize,db_type:b.value.type,db_pool_size:b.value.poolSize,db_timeout:b.value.timeout,plugin_timeout:x.value.timeout,plugin_work_dir:x.value.workDir,plugin_auto_update:x.value.autoUpdate});if(!t.success)throw Error(t.message||`保存配置失败`);g.success(e)}catch(e){g.error(e instanceof Error?e.message:`保存配置失败`)}finally{v.value=!1}},w=async()=>{await C(`系统配置已保存`)},T=async()=>{await C(`数据库配置已保存`)},E=async()=>{await C(`插件配置已保存`)};return n(()=>{S()}),(n,u)=>{let d=c(`el-input`),m=c(`el-form-item`),g=c(`el-switch`),S=c(`el-input-number`),C=c(`el-button`),D=c(`el-form`),O=c(`el-tab-pane`),k=c(`el-option`),A=c(`el-select`),j=c(`el-tabs`),M=c(`el-card`),N=i(`loading`);return s(),o(`div`,_,[h((s(),t(M,{class:`box-card`},{header:l(()=>[...u[11]||=[a(`div`,{class:`card-header`},[a(`span`,null,`系统设置`)],-1)]]),default:l(()=>[r(j,{modelValue:f.value,"onUpdate:modelValue":u[10]||=e=>f.value=e},{default:l(()=>[r(O,{label:`系统配置`,name:`system`},{default:l(()=>[r(D,{model:y.value,"label-width":`150px`,style:{"max-width":`600px`}},{default:l(()=>[r(m,{label:`系统名称`},{default:l(()=>[r(d,{modelValue:y.value.name,"onUpdate:modelValue":u[0]||=e=>y.value.name=e,placeholder:`Cornerstone`},null,8,[`modelValue`])]),_:1}),r(m,{label:`系统描述`},{default:l(()=>[r(d,{modelValue:y.value.description,"onUpdate:modelValue":u[1]||=e=>y.value.description=e,type:`textarea`,rows:3,placeholder:`数据管理平台`},null,8,[`modelValue`])]),_:1}),r(m,{label:`允许用户注册`},{default:l(()=>[r(g,{modelValue:y.value.allowRegistration,"onUpdate:modelValue":u[2]||=e=>y.value.allowRegistration=e},null,8,[`modelValue`])]),_:1}),r(m,{label:`最大文件大小(MB)`},{default:l(()=>[r(S,{modelValue:y.value.maxFileSize,"onUpdate:modelValue":u[3]||=e=>y.value.maxFileSize=e,min:1,max:1024},null,8,[`modelValue`])]),_:1}),r(m,null,{default:l(()=>[r(C,{type:`primary`,onClick:w,loading:v.value},{default:l(()=>[...u[12]||=[e(`保存配置`,-1)]]),_:1},8,[`loading`])]),_:1})]),_:1},8,[`model`])]),_:1}),r(O,{label:`数据库配置`,name:`database`},{default:l(()=>[r(D,{model:b.value,"label-width":`150px`,style:{"max-width":`600px`}},{default:l(()=>[r(m,{label:`数据库类型`},{default:l(()=>[r(A,{modelValue:b.value.type,"onUpdate:modelValue":u[4]||=e=>b.value.type=e,placeholder:`请选择`},{default:l(()=>[r(k,{label:`PostgreSQL`,value:`postgresql`}),r(k,{label:`MySQL`,value:`mysql`}),r(k,{label:`SQLite`,value:`sqlite`})]),_:1},8,[`modelValue`])]),_:1}),r(m,{label:`连接池大小`},{default:l(()=>[r(S,{modelValue:b.value.poolSize,"onUpdate:modelValue":u[5]||=e=>b.value.poolSize=e,min:1,max:100},null,8,[`modelValue`])]),_:1}),r(m,{label:`超时时间(秒)`},{default:l(()=>[r(S,{modelValue:b.value.timeout,"onUpdate:modelValue":u[6]||=e=>b.value.timeout=e,min:1,max:300},null,8,[`modelValue`])]),_:1}),r(m,null,{default:l(()=>[r(C,{type:`primary`,onClick:T,loading:v.value},{default:l(()=>[...u[13]||=[e(`保存配置`,-1)]]),_:1},8,[`loading`])]),_:1})]),_:1},8,[`model`])]),_:1}),r(O,{label:`插件配置`,name:`plugins`},{default:l(()=>[r(D,{model:x.value,"label-width":`150px`,style:{"max-width":`600px`}},{default:l(()=>[r(m,{label:`插件超时(秒)`},{default:l(()=>[r(S,{modelValue:x.value.timeout,"onUpdate:modelValue":u[7]||=e=>x.value.timeout=e,min:1,max:600},null,8,[`modelValue`])]),_:1}),r(m,{label:`工作目录`},{default:l(()=>[r(d,{modelValue:x.value.workDir,"onUpdate:modelValue":u[8]||=e=>x.value.workDir=e,placeholder:`/var/plugins`},null,8,[`modelValue`])]),_:1}),r(m,{label:`自动更新`},{default:l(()=>[r(g,{modelValue:x.value.autoUpdate,"onUpdate:modelValue":u[9]||=e=>x.value.autoUpdate=e},null,8,[`modelValue`])]),_:1}),r(m,null,{default:l(()=>[r(C,{type:`primary`,onClick:E,loading:v.value},{default:l(()=>[...u[14]||=[e(`保存配置`,-1)]]),_:1},8,[`loading`])]),_:1})]),_:1},8,[`model`])]),_:1})]),_:1},8,[`modelValue`])]),_:1})),[[N,p.value]])])}}}),[[`__scopeId`,`data-v-17f40fea`]]);export{v as default};